package main

import (
	"flag"
	"os"

	"github.com/joho/godotenv"

	"nvdbase/cmd"
)

func main() {
	godotenv.Load(".env")
	groqApiKey := os.Getenv("GROQ_API_KEY")
	dataPath := os.Getenv("DATA_PATH")
	var outputFilePath string
	var command string
	flag.StringVar(
		&outputFilePath,
		"o",
		"files/pkg_info.json",
		"The output file to write the affected package information to.",
	)
	flag.StringVar(
		&command,
		"c",
		"ingest",
		"Specify whether to ingest data from 2023-2024 or start an update script",
	)
	flag.Parse()

	if command == "ingest" {
		cmd.Ingest(dataPath, outputFilePath, groqApiKey)
	}
	if command == "update" {
		cmd.Update(dataPath, outputFilePath, groqApiKey)
	}
}
