package cve

type NvdResponse struct {
	ResultsPerPage  int             `json:"resultsPerPage"`
	StartIndex      int             `json:"startIndex"`
	TotalResults    int             `json:"totalResults"`
	Format          string          `json:"format"`
	Version         string          `json:"version"`
	Timestamp       string          `json:"timestamp"`
	Vulnerabilities []Vulnerability `json:"vulnerabilities"`
}

type Vulnerability struct {
	Cve Cve `json:"cve"`
}

type Cve struct {
	References  References  `json:"references"`
	CveMetaData CveMetaData `json:"CVE_data_meta"`
}

type CveMetaData struct {
	Id       string `json:"ID"`
	Assigner string `json:"ASSIGNER"`
}

type References struct {
	ReferenceData []ReferenceData `json:"reference_data"`
}

type ReferenceData struct {
	Url       string   `json:"url"`
	Name      string   `json:"name"`
	Refsource string   `json:"refsource"`
	Tags      []string `json:"tags"`
}

type PackageInfoNVD struct {
	GHSAId string `json:"ghsa_id"`
	Commit string `json:"commit"`
	Cve    string `json:"cve"`
}

type PackageInfoOVS struct {
	Id       string            `json:"id"`
	Summary  string            `json:"summary"`
	Details  string            `json:"details"`
	Affected []AffectedPackage `json:"affected"`
}

type PackageListOVS struct {
	Vulns []PackageInfoOVS `json:"vulns"`
}

type AffectedPackage struct {
	Package  map[string]string `json:"package"`
	Ranges   []map[string]any  `json:"ranges"`
	Versions []string          `json:"versions"`
}

type NvdDataStatic struct {
	CVEDataType         string          `json:"CVE_data_type"`
	CVEDataFormat       string          `json:"CVE_data_format"`
	CVEDataVersion      string          `json:"CVE_data_version"`
	CVEDataNumberOfCVES string          `json:"CVE_data_number_of_cves"`
	CVEDataTimestamp    string          `json:"CVE_data_timestamp"`
	CVEItems            []Vulnerability `json:"CVE_items"`
}

type PackageEntry struct {
	Cve              string            `json:"cve"`
	AffectedPackages []AffectedPackage `json:"affected_packages"`
}
