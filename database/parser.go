package database

import (
	"io"
	"os"

	"nvdbase/cve"
)

func JSONParser(filename string) (cve.NvdDataStatic, error) {
	var nvdData cve.NvdDataStatic
	jsonObj, err := os.Open(filename)
	if err != nil {
		return cve.NvdDataStatic{}, err
	}
	defer jsonObj.Close()

	body, err := io.ReadAll(jsonObj)
	if err != nil {
		return cve.NvdDataStatic{}, err
	}

	err = cve.Decode(body, &nvdData)
	if err != nil {
		return cve.NvdDataStatic{}, err
	}

	return nvdData, nil
}
