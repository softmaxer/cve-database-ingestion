package database

import (
	"log"

	"nvdbase/cve"
)

func getAffectedPackages(pkgInfo *cve.PackageInfoNVD) []cve.AffectedPackage {
	log.Println("Getting affected packages for ", pkgInfo.Cve)
	additionalInfo := getAdditionalInformation(pkgInfo)
	var affectedPackages []cve.AffectedPackage
	for _, vuln := range additionalInfo.Vulns {
		for _, affected := range vuln.Affected {
			if affected.Package["ecosystem"] != "Maven" {
				continue
			}
			affectedPackages = append(affectedPackages, affected)
		}
	}
	return affectedPackages
}
