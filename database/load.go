package database

import (
	"log"

	"nvdbase/cve"
)

func LoadData(dataPaths ...string) []cve.Vulnerability {
	var vulnerabilities []cve.Vulnerability = []cve.Vulnerability{}
	for _, path := range dataPaths {
		nvdData, err := JSONParser(path)
		if err != nil {
			log.Printf("Error opening datafile: %s\n", err.Error())
			continue
		}
		vulnerabilities = append(vulnerabilities, nvdData.CVEItems...)
	}

	return vulnerabilities
}
